<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><%= title %> - LuxRide</title>
    <link rel="stylesheet" href="/css/styles.css">
    <link rel="stylesheet" href="/css/footer.css">
</head>
<body>
    <%- include('../partials/header') %>
    <section class="filter-section" style="border-bottom:none; padding-top: 4rem;">
        <h2 style="margin-bottom: 1rem;"><%= car ? 'Edit Car' : 'Add Car' %></h2>
        <form action="<%= car ? '/admin/cars/' + car._id + '/edit' : '/admin/cars/new' %>" method="POST" enctype="multipart/form-data" class="filter-form" style="max-width: 720px; position:relative;">
            <% if (typeof errors !== 'undefined' && errors.length) { %>
                <div class="validation-banner-container">
                    <div class="validation-banner" role="alert">
                        <ul style="margin:0; padding-left:1rem; text-align:left;">
                            <% errors.forEach(function(err){ %>
                                <li><%= err.msg %></li>
                            <% }) %>
                        </ul>
                    </div>
                </div>
            <% } %>
            <div class="form-row" style="max-width: 100%;">
                <label for="name">Name</label>
                <input type="text" id="name" name="name" required value="<%= car ? car.name : '' %>">
            </div>
            <div class="form-row" style="max-width: 100%;">
                <label for="transmission">Transmission</label>
                <select id="transmission" name="transmission" required>
                    <option value="Automatic" <%= car && car.transmission === 'Automatic' ? 'selected' : '' %> >Automatic</option>
                    <option value="Manual" <%= car && car.transmission === 'Manual' ? 'selected' : '' %> >Manual</option>
                </select>
            </div>
            <div class="form-row" style="max-width: 100%;">
                <label for="seats">Seats</label>
                <select id="seats" name="seats" required>
                    <% for (var s = 2; s <= 9; s++) { %>
                        <option value="<%= s %>" <%= car && Number(car.seats) === s ? 'selected' : '' %> ><%= s %></option>
                    <% } %>
                </select>
            </div>
            <!-- category selector removed -->
            <div class="form-row" style="max-width: 100%;">
                <label for="fuelType">Fuel Type</label>
                <select id="fuelType" name="fuelType" required>
                    <option value="Petrol" <%= car && car.fuelType === 'Petrol' ? 'selected' : '' %> >Petrol</option>
                    <option value="Diesel" <%= car && car.fuelType === 'Diesel' ? 'selected' : '' %> >Diesel</option>
                    <option value="Hybrid" <%= car && car.fuelType === 'Hybrid' ? 'selected' : '' %> >Hybrid</option>
                    <option value="Electric" <%= car && car.fuelType === 'Electric' ? 'selected' : '' %> >Electric</option>
                </select>
            </div>
            <div class="form-row" style="max-width: 100%; display:grid; grid-template-columns: repeat(3, minmax(0,1fr)); gap:1rem; align-items:end;">
                <div>
                    <label for="priceTier_1_3">1–3 days (€ / day)</label>
                    <input type="number" step="0.01" min="0" id="priceTier_1_3" name="priceTier_1_3" value="<%= car && car.priceTier_1_3 != null ? car.priceTier_1_3 : '' %>" placeholder="<%= car ? (car.priceTier_1_3 != null ? car.priceTier_1_3 : '') : '' %>">
                </div>
                <div>
                    <label for="priceTier_7_31">7–31 days (€ / day)</label>
                    <input type="number" step="0.01" min="0" id="priceTier_7_31" name="priceTier_7_31" value="<%= car && car.priceTier_7_31 != null ? car.priceTier_7_31 : '' %>" placeholder="<%= car ? (car.priceTier_7_31 != null ? car.priceTier_7_31 : '') : '' %>">
                </div>
                <div>
                    <label for="priceTier_31_plus">31+ days (€ / day)</label>
                    <input type="number" step="0.01" min="0" id="priceTier_31_plus" name="priceTier_31_plus" value="<%= car && car.priceTier_31_plus != null ? car.priceTier_31_plus : '' %>" placeholder="<%= car ? (car.priceTier_31_plus != null ? car.priceTier_31_plus : '') : '' %>">
                </div>
            </div>
            <div class="form-row" style="max-width:100%; margin-top:.25rem; font-size:.9rem; opacity:.8;">
                <em>The base per-day price will be derived automatically from these tiers.</em>
            </div>
            <div class="form-row" style="max-width: 100%;">
                <label for="image">Image</label>
                <input type="file" id="image" name="image" accept="image/*">
                <% if (car && car.image) { %>
                    <div style="margin-top:.5rem;">
                        <img src="<%= car.image %>" alt="Current image" style="width:160px; height:110px; object-fit:cover; border-radius:6px; border:2px solid #ffd23f;" />
                    </div>
                <% } %>
            </div>
            <% if (car) { %>
            <div class="form-row" style="max-width: 100%;">
                <label for="availability">Available</label>
                <input type="checkbox" id="availability" name="availability" <%= car.availability ? 'checked' : '' %> >
            </div>
            <% } %>
            <div class="submit-row">
                <button type="submit" class="btn"><%= car ? 'Save Changes' : 'Create Car' %></button>
            </div>
        </form>
    </section>
    <style>
        @media (max-width: 900px) {
            .grid-cards { grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)) !important; }
        }
        @media (max-width: 700px) {
            .grid-cards { grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)) !important; }
        }
        @media (max-width: 520px) {
            .grid-cards { grid-template-columns: 1fr !important; }
            .filter-form { padding: 1.1rem 0.9rem !important; gap: 0.9rem; }
            .form-row { max-width: 100% !important; }
            .form-row select, .form-row input { width: 100%; }
            .submit-row .btn { width: 100%; }
        }
    </style>
    <%- include('../partials/footer') %>
    <script src="/js/mobileNav.js"></script>
</body>
<html>


